<head>
  <title>castle</title>
</head>

<body>
</body>

<template name="home">
  <div class="container">
    <div class="center jumbotron">
    {{#if hasUser}}
      <h1>Hi {{getDisplayName user._id}}! Click to join room.</h1>
      <input id="create_room" type='button' value='Create Room' class="btn btn-lg btn-default"/>
      {{> rooms}}
    {{else}}
      <h1>Want to play Castle of the Devil?</h1>
      <p class="lead">Please log in!</p>
       {{> loginButtons}}
    {{/if}}
    </div>
  </div>
</template>

<template name="rooms">
 
  {{#each rooms}}
    {{> room}}
  {{/each}}

</template>

<template name="room">
  <div class="row room_content">
    <h4>Room name: {{_id}}</h4>
    <h4>Current players:</h4>
    <ul class="list-unstyled">
      {{#each users}}
        <li class="username"><h5>{{getDisplayName _id}}</h5></li>
      {{/each}}
    </ul>
    {{#if notCreator}}
      <input id="join_room" type='button' value='Join' class="btn btn-success">
    {{/if}}
    <input id="start_game" type='button' value='Start' class="btn btn-success">
    <input id="leave_room" type='button' value='Leave' class="btn btn-failure">
  </div>
</template>

<template name="game">
  {{#with context}}
    <h1>Game {{_id}}</h1>
    {{> player_statuses}}
    {{#with me}}
      {{> my_status}}
    {{/with}}
    <h3>My actions</h3>
    {{> my_action_template}}
  {{/with}}
</template>

<template name="player_statuses">
  <h3>Players</h3>
  <ul class="player-statuses">
  {{#each players}}
    <li>
      {{getDisplayName _id}}
  </li>
  {{/each}}
  </ul>
</template>

<template name="my_status">
  <h3>My Status</h3>
  <ul>
    <li>{{getDisplayName _id}}</li>
    <li>
      {{#if this.assoc}}
        Society of Open Secrets
      {{else}}
        Order of True Lies
      {{/if}}
    </li>
    <li>Turn Order: {{this.turn}}</li>
    <li>Profession: {{getProfessionName this.prof}}</li>
  </ul>
</template>

<template name="TURN_START">
  {{#if is_my_action}}
    <h4>It's your turn! Choose an action: </h4>
    <input class="btn btn-success turn_start" id="play_profession" type="button" value="Play Profession" />
  {{else}}
    <h4>Waiting on {{getDisplayName state.user}} to choose an action.</h4>
  {{/if}}
</template>

<template name="PLAY_PROFESSION">
  {{#if is_my_action}}
    {{#if state.meta.success}}
      <h4>You have chosen to play {{getProfessionName state.meta.prof_id}}!</h4>
      <input class="btn btn-success play_profession" type="button" value="Next" />
    {{else}}
      <h4>Trying to play profession...</h4>
    {{/if}} 
  {{else}}
    {{#if state.meta.success}}
      <h4>{{getDisplayName state.user}} has chosen to play {{getProfessionName state.meta.prof_id}}!</h4>
    {{else}}
      <h4>Waiting on {{getDisplayName state.user}} to finish playing profession.</h4>
    {{/if}} 
  {{/if}}
</template>