<template name='action'>
  {{> my_action_template}}
</template>

<template name="TURN_START">
  {{#if is_my_action}}
    <h4>It's your turn! Choose an action: </h4>
    <input class="btn btn-success" id="begin_combat" type="button" value="Begin Combat" />
    <input class="btn btn-success turn_start" id="play_profession" type="button" value="Play Profession" />
    <input class="btn btn-success" id="declare_victory" type="button" value="Declare Victory" />
  {{else}}
    <h4>Waiting on {{getDisplayName game.state.user}} to choose an action.</h4>
  {{/if}}
</template>

<template name="PLAY_PROFESSION">
  {{#if is_my_action}}
    {{#if game.state.meta.success}}
      <h4>You have chosen to play {{getProfessionName game.state.meta.prof}}!</h4>
      <input class="btn btn-success play_success" type="button" value="Next" />
    {{else}}
      <h4>Trying to play profession...Did not succeed.</h4>
      <input class="btn btn-failure play_failure" type="button" value="Go back" />
    {{/if}} 
  {{else}}
    {{#if game.state.meta.success}}
      <h4>{{getDisplayName game.state.user}} has chosen to play {{getProfessionName game.state.meta.prof}}!</h4>
    {{else}}
      <h4>{{getDisplayName game.state.user}} tried to play profession...Did not succeed.</h4>
    {{/if}} 
  {{/if}}
</template>

<template name="FREE_RESPONSE">
  {{#if is_my_action}}
    <h4>Your chance to play a profession or a card! Choose an action: </h4>
    <input class="btn btn-success" id="play_profession" type="button" value="Play Profession" />
    <input class="btn btn-success" id="play_card" type="button" value="Play Card" />
    <input class="btn btn-failure" id="do_nothing" type="button" value="Do Nothing" />
  {{else}}
    <h4>Waiting on {{getDisplayName game.state.wait_on}} to play something.</h4>
  {{/if}}
</template>

<template name="BEGIN_COMBAT">
{{#if is_my_action}}
  <h4>Choose someone to attack!</h4>
  <div>
  {{#each game.players}}
    {{#if isMe _id}}
    {{else}}
      <label class="radio-inline">
        <input type="radio" name="target" value="{{_id}}" >
        {{getDisplayName _id}}
      </label>
    {{/if}}
  {{/each}}
  </div><br />
  <input class="btn btn-success" id="choose_attack" type="button" value="Declare Attack" />
{{else}}
  <h4>Waiting on {{getDisplayName game.state.wait_on}} to choose who to attack.</h4>
{{/if}}
</template>

<template name="DECLARE_SUPPORT">
{{#if is_my_action}}
  {{#if game.state.meta.success}}
    <h4>You have chosen to support {{getDisplayName game.state.meta.supports}}!</h4>
    <input class="btn btn-success" id="support_success" type="button" value="Next" />
  {{else}}
  <h4>Choose who to support!</h4>
  <div>
  {{#each game.players}}
    {{#if attacking}}
      <label class="radio-inline">
        <input type="radio" name="support" value="{{_id}}" >
        {{getDisplayName _id}} (Attacking)
      </label>
    {{else}}
      {{#if defending}}
      <label class="radio-inline">
        <input type="radio" name="support" value="{{_id}}" >
        {{getDisplayName _id}} (Defending)
      </label>
      {{/if}}
    {{/if}}
  {{/each}}
  </div><br />
  <input class="btn btn-success" id="choose_support" type="button" value="Declare Support" />
  {{/if}}
{{else}}
  {{#if game.state.meta.success}}
    <h4>{{getDisplayName game.state.wait_on}} supports 
    {{getDisplayName game.state.meta.supports}}!</h4>
  {{else}}
    <h4>Waiting on {{getDisplayName game.state.wait_on}} to choose who to support.</h4>
  {{/if}}
{{/if}}
</template>

<template name="DECLARE_VICTORY">
  {{#if game.state.meta.success}}
    <div>
      <b>{{getDisplayName game.state.user}}</b> declared victory for <b>team</b>:
    {{get_association_name game.state.meta.nominated_team}}
    with <b>teammates</b>:
    </div>
    <div>
    {{#each game.state.meta.nominated_player_ids}}
      {{getDisplayName this}}
      <ul>
        {{#each getPlayerCardNames this}}
          <li>{{ this }}</li> 
        {{/each}}

      </ul>
    {{/each}}
    </div>

    <b>
    {{#if game.state.meta.res}}
      Declaration successful
    {{else}}
      Declaration unsuccessful
    {{/if}}
    </b>

    <b>
    {{#if did_i_win}}
      Congrats, you win!
    {{else}}
      Sorry, you lose!
    {{/if}}
    </b>
  {{else}}
    {{#if is_my_action}}
      <div class="form-group">
        <b>Declare victory for:</b>
        <div>
          <label class="radio-inline">
            <input type="radio" name="nominated_team" id="blue" value="0" {{nominated_team_radio 0}}>
            {{get_association_name 0}}
          </label>
          <label class="radio-inline">
            <input type="radio" name="nominated_team" id="red" value="1" {{nominated_team_radio 1}}>
            {{get_association_name 1}}
          </label>
        </div>

        <b>Nominate players:</b>
        <div>
          {{#each game.players}}
          <label>
            <input type="checkbox" name="nominated_player" value="{{this._id}}" {{nominated_player_checkbox this._id}}>{{getDisplayName this._id}}
          </label>
          {{/each}}
        </div>
        <div>
          <input class="btn btn-success" id="make_declaration" type="button" value="Make Declaration" />
          <input class="btn btn-failure" type="button" value="Go back" />
        </div>
      </div>
    {{else}}
      <h4>{{getDisplayName game.state.user}} is declaring victory!!</h4>
    {{/if}}
  {{/if}}
</template>
